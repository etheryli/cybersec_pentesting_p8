# Project 8 - Pentesting Live Targets

Time spent: **X** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

#### Vulnerability #1: SQL Injection
- The id parameter is vulnerable to SQL Injection like the example shown, using ' OR SLEEP(5)=0--' for the id, where it goes to sleep for 5 seconds and default back to the person with id 1.

<img src='http://i.imgur.com/oFhz0Ap.gif' title='Gif Walkthrough' width='' alt='Gif Walkthrough' />

#### Vulnerability #2: Session Hijacking/Fixation
- Administrator log in can be bypassed by stealing another logged in session ID and using that session ID to gain privileges. (Attacker is on the left in the GIF)
<img src='http://i.imgur.com/tinVjs9.gif' title='Gif Walkthrough' width='' alt='Gif Walkthrough' />

## Green

#### Vulnerability #1: Username Enumeration
* The login page returns a bolded text "Log in was unsuccessful" for existing username (ie. jmonroe99), but normal text for any other usernames, with any random passwords for both kinds of users. Red and Blue sites always return bolded text. An attacker can simply bruteforce to enumerate a list of users.

<img src='http://i.imgur.com/PKtsOGk.gif' title='Gif Walkthrough' width='' alt='Gif Walkthrough' />

#### Vulnerability #2: Cross-Site Scripting
- The Contact form's feedback field can be injected with with a stored XSS, that is executed when the administrator logins to view the feedback. (Note: The first 6 iframes feedbacks were all 1's and could not be deleted, thus the next few could not be displayed with any other text of my name).
`<iframe onload=alert(1)></iframe>`

<img src='http://i.imgur.com/6ZROnnl.gif' title='Gif Walkthrough' width='' alt='Gif Walkthrough' />

## Red

#### Vulnerability #1: Insecure Direct Object Reference 
- Simply change the number of the id in the URL
- ID 10 and 11 are employees not shown on the "Find a Salesperson" page, and they are not supposed to be accessible indicated by the comments next to their names.
- Blue and Green sites check access control and redirect the page to the main directory page again.

<img src='http://i.imgur.com/iPvAp7C.gif' title='Gif Walkthrough' width='' alt='Gif Walkthrough' />

#### Vulnerability #2: Cross-Site Request Forgery
- A malicious link to the form can be clicked by the administrator log in session to carry out the hidden form for the edit POST request
- ClickMe Hidden form:
```
<html>
  <head>
    <title>Fake Form</title>
  </head>
  <body onload="document.edit_salesperson.submit()">
    <form action="https://35.194.42.150/red/public/staff/salespeople/edit.php?id=2" method="POST" name="edit_salesperson" style="display: none;" target="hidden_results" >
      <input type="text" name="first_name" value="Hung"><br>
      <input type="text" name="last_name" value="CSRF"><br>
      <input type="text" name="phone" value="133-713-3713"><br>
      <input type="text" name="email" value="csrf@csrf.com"><br>
    </form>
    <iframe name="hidden_results" style="display: none;"></iframe>
  </body>
</html>
```

<img src='http://i.imgur.com/O79SgFe.gif' title='Gif Walkthrough' width='' alt='Gif Walkthrough' />

## Notes
## License

    Copyright [2017] [Hung Nguyen]

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
